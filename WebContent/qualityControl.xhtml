<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core">



<h:head>
	<title>Adaptive Radiology Interpretation / Education System
		(ARIES)</title>

	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />

	<!-- Bootstrap -->
	<link href="./resources/css/bootstrap.min.css" rel="stylesheet" />
	<link href="./resources/css/bootstrap-theme.min.css" rel="stylesheet" />
	<link href="./css/newStyle.css" rel="stylesheet" type="text/css" />
	<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
	<script
		src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<!-- Include all compiled plugins (below), or include individual files as needed -->
	<script src="./resources/js/bootstrap.min.js"></script>
	<style>
a {
	text-decoration: underline;
}

input[type=checkbox], input[type=radio] {
	margin-right: 1px;
	margin-left: 1px;
}

.nav-tabs {
	border-bottom: 0px solid #ddd;
}
</style>

</h:head>
<h:body id="bodyStyle">
	<f:view>
		<h:form role="form" id="caseInput">



			<div class='row' id="divStyle" style="color: white;">
				<div class="col-md-3">
					<img alt="ARIES" src="aries.png" /><br /> <font size="-2">Build
						7-30-2015</font>
				</div>
				<div class="col-md-6">

					<br></br> <br></br>
					<h3>
						Adaptive Radiology Interpretation
						&amps;
						Education System (ARIES)
					</h3>

				</div>
				<div class="col-md-3">
					<br></br> <br></br> <font size="-1">Hospital of University
						of Pennsylvania <br /> Department of Radiology Based on <br />the
						Work of Emmanuel Botzolakis<br /> Designed by Howard Chen <br />
						<a href="https://www.gnu.org/copyleft/gpl.html">GNU Public
							License</a>
					</font>
				</div>

			</div>
			<div style="background-color: #37373B;">

				<div style="color: white;">

					<label>Welcome, #{loginBean.uname}</label>
				</div>

				<div class="row">

					<div class="col-md-11">
						<ul class="nav nav-tabs">
							<li><a href="/ARIES/">Home</a></li>
							<li><a href="/ARIES/index.jsf">Clinical</a></li>
							<li><a href="/ARIES/caseInput_form.jsf">Submit
									Case</a></li>
							<li><a href="/ARIES/research.jsf">Research</a></li>
							<li class="active"><a href="/ARIES/qualityControl.jsf">QC</a></li>

						</ul>
					</div>
					<div class="col-md-1">
						<h:commandButton icon="glyphicon glyphicon-lock"
							class="btn btn-primary" value="Logout"
							action="#{loginBean.logout}" />
					</div>
				</div>
			</div>
			<!-- <div>

				<a href="/ARIES/">Back To Home</a>

			</div> -->

			<div class="row">

				<div class="col-md-3"></div>
				<div class="col-md-6">
					<h:outputText id="errorMsg" value="#{serverModel.errorMsg}"
						escape="false"></h:outputText>
					<h:messages globalOnly="true" style="color:red;font-weight:bold;"></h:messages>
				</div>
			</div>

			<div class="container">
				<p>
					<br />
				</p>
				<div class="form-group" style="text-align: center ;">
				    <div class="col-md-2"></div>
					<div class="col-md-2" style="color:white">
						<label for="networkqc">Network :<font color="red">*</font>
						</label>
					</div>
					<div class="input-group" >


						<h:selectOneMenu id="networkqc" value="#{serverModel.nwNameforQC}"
							onchange="this.form.submit()"
							valueChangeListener="#{serverModel.getQCPrePageLoad}">
							<f:selectItem itemLabel="-select-" itemValue="-select-"></f:selectItem>
							<f:selectItems value="#{serverModel.networkNameList}"></f:selectItems>
						</h:selectOneMenu>

					</div>
				</div>
				<div class="row">
					<div class="form-group" style="text-align: center;">
					<div class="col-md-2"></div>
						<div class="col-md-2" style="color:white">
							<label for="caseNoQC">Select Case for QC :</label>
						</div>

						<div class="input-group" >
							<h:selectOneMenu id="caseNoQC" value="#{serverModel.caseNoforQCSetter}">
								<f:selectItems value="#{serverModel.selectCaseList}" />
							</h:selectOneMenu>
						</div>
					</div>
                    <div class="col-md-3"></div>
					<div class="col-md-2">
						<h:commandButton id="qcbutton" value="QC" class="btn btn-primary"
							action="#{serverModel.doQC}" />
						
						
					</div>
					
				</div>

				<p>
					<br />
				</p>
				
				<div class="row" id="maindiv">
					<div class="col-md-1"></div>
					<div class="col-md-10">
						<div class="panel panel-primary" style="background-color: #00CCFF">
							<div class="panel-heading" align="center">
								<h4>Case Submission Form</h4>
							</div>
							<div class="panel-body">


								<fieldset id="formDiv">
									
									<div class="form-group" style="text-align: center;">
										<div class="col-md-4">

											<label for="organization">Organization<font
												color="red">*</font></label>
										</div>
										<div class="input-group">


											<h:selectOneMenu value="#{serverModel.organization}">
												<f:selectItem itemLabel="-select-"></f:selectItem>
												<f:selectItem itemValue="CHOP" itemLabel="CHOP"></f:selectItem>
												<f:selectItem itemValue="UPHS" itemLabel="UPHS"></f:selectItem>
											</h:selectOneMenu>

										</div>
									</div>

									<div class="form-group" style="text-align: center;">
										<div class="col-md-4">

											<label for="modality">Modality : <font color="red">*</font></label>
										</div>
										<div class="input-group">
 

											<h:selectOneMenu id="modality"
												value="#{serverModel.modality}">
												<f:selectItem itemLabel="-select-"></f:selectItem>
												<f:selectItem itemValue="MR" itemLabel="MR"></f:selectItem>
												<f:selectItem itemValue="XR" itemLabel="XR"></f:selectItem>
												<f:selectItem itemValue="CT" itemLabel="CT"></f:selectItem>
											</h:selectOneMenu>

										</div>
									</div>

									<div class="form-group" style="text-align: center;">
										<div class="col-md-4">
											<label for="accession">Accession :<font color="red">*</font></label>
										</div>
										<div class="input-group">

											<h:inputText id="accession" value="#{serverModel.accession}"
												onblur="return validate()" />

										</div>
										<div id="error" style="color: red"></div>
									</div>


									<div class="form-group" style="text-align: center;">
										<div class="col-md-4">
											<label for="mrNum">MR Number(Last 5) : <font
												color="red">*</font></label>
										</div>
										<div class="input-group">

											<h:inputText id="mrNum" value="#{serverModel.patientId}"
												maxlength="5"></h:inputText>

										</div>
									</div>

									<div class="form-group" style="text-align: center;">
										<div class="col-md-4">
											<label for="age">Patient Age :<font color="red">*</font></label>
										</div>
										<div class="input-group">

											<h:inputText id="age" value="#{serverModel.age}"
												maxlength="3" onblur="return checkNumber()" />

										</div>
										<div id="age_error" style="color: red"></div>
									</div>

									<div class="form-group" style="text-align: center;">
										<div class="col-md-4">

											<label for="gender">Gender : <font color="red">*</font></label>
										</div>
										<div class="input-group">


											<h:selectOneRadio id="gender" value="#{serverModel.gender}">
												<f:selectItem itemValue="Female" itemLabel="Female"></f:selectItem>
												<f:selectItem itemValue="Male" itemLabel="Male"></f:selectItem>
											</h:selectOneRadio>

										</div>
									</div>

									<div class="form-group" style="text-align: center;">
										<div class="col-md-4">

											<label for="supportData">Supporting Data : <font
												color="red">*</font></label>
										</div>
										<div class="input-group">


											<h:selectManyCheckbox id="supportData"
												value="#{serverModel.supportingDataList}">
												<f:selectItem itemValue="pathology" itemLabel="pathology"></f:selectItem>
												<f:selectItem itemValue="laboratory" itemLabel="laboratory"></f:selectItem>
												<f:selectItem itemValue="clinical history"
													itemLabel="clinical history"></f:selectItem>
												<f:selectItem itemValue="imaging findings"
													itemLabel="imaging findings"></f:selectItem>

											</h:selectManyCheckbox>

										</div>
									</div>

									<div class="form-group" style="text-align: center;">
										<div class="col-md-4">
											<label for="description">Supporting data details : <font
												color="red">*</font></label>
										</div>
										<div class="input-group">

											<h:inputTextarea value="#{serverModel.description}"
												style="height:80px;width:260px;"></h:inputTextarea>
										</div>

									</div>



									<div class="form-group" style="text-align: center;">
										<div class="col-md-4">
											<label for="diagnosis">Correct Diagnosis :<font
												color="red">*</font></label>
										</div>
										<div class="input-group">

											<h:selectOneMenu id="diagnosis"
												value="#{serverModel.correctDx}" onchange='this.form.submit();showText()'>
												<f:selectItem itemLabel="-select-"></f:selectItem>
												<f:selectItem itemValue="Other" itemLabel="Other"></f:selectItem>
												<f:selectItems value="#{serverModel.diseaseTitles}"></f:selectItems>
											</h:selectOneMenu>


										</div>
									</div><div class="form-group" style="text-align: center;"
										id="inputTex">
										<div class="col-md-4"></div>
										<div class="input-group">
											<h:inputText value="#{serverModel.correctDxText}" />
										</div>
									</div>
									

									<div class="form-group" style="text-align: center;">
										<div class="col-md-4">
											<label for="qcperson">QC Person :<font color="red">*</font></label>
										</div>
										<div class="input-group">

											<h:selectOneMenu id="qcperson"
												value="#{serverModel.qcperson}">
												<f:selectItems value="#{serverModel.usersList}"></f:selectItems>
											</h:selectOneMenu>


										</div>
									</div>

									<p>
										<br />
									</p>
									<div class="form-group">
										<div class="col-md-3"></div> 

										<div class="col-md-2">
											<h:commandButton id="submit_btn" class="btn btn-primary"
												value="Case Submit" action="#{serverModel.save}"
												reRender="accession,organization,network,mrNum,description,modality,diagnosis" />
										</div>
										<div class="col-md-1">
											<h:commandButton id="reset" value="Reset"
												class="btn btn-primary" action="#{serverModel.clear}"
												reRender="accession,organization,network,mrNum,description,modality,diagnosis" />
										</div>
 


									</div>
								</fieldset>
								<div id="feature_pg">
									<div class="row">

										<div class="col-md-2"></div>
										<div class="col-md-8">
											<h:outputText id="infoMsg" value="#{serverModel.infoMsg}"
												escape="false"></h:outputText>
										</div>
									</div>
									<h3>Enter Inputs for Case No:#{serverModel.caseid}</h3>
									<ui:repeat var="networkPrefix"
										value="#{serverModel.networkPrefixList}">

										<h:panelGrid id="pg_inputs" cellspacing="2"
											rendered="#{serverModel.getFeaturesRendered(networkPrefix)}">
											<h:outputText
												value="#{serverModel.getNetworkPrefixName(networkPrefix)}" />

											<ui:repeat var="feature"
												value="#{serverModel.getSelectMenuFeatures(networkPrefix)}">

												<h:outputText value="#{serverModel.currentFeature(feature)}" />

												<h:selectOneMenu id="sensitivity"
													class="features ${serverModel.featureClass(feature)}"
													value="#{serverModel.featureValue}"
													onchange="this.form.submit()">
													<f:selectItems
														value="#{serverModel.selectMenuInputsFromCase(feature)}" />
												</h:selectOneMenu>


											</ui:repeat> 
										</h:panelGrid> 

									</ui:repeat>
									<p>
										<br />
									</p>
									<div class="form-group">
										<div class="col-md-3"></div>
										<div class="col-md-2">
											<h:commandButton id="edit"
												action="#{serverModel.getReviewQCCaseList}"
												class="btn btn-primary" value="Review Case" />
										</div>
										<div class="col-md-2">
											<h:commandButton id="done_btn" class="btn btn-success"
												value="Done" action="#{serverModel.qcSelectionDone}" />
										</div>
										<div class="col-md-2">
											<h:commandButton id="del_btn" class="btn btn-danger"
												value="Delete" action="#{serverModel.deleteCase}" />
										</div>
										
										

									</div>
								</div>

							</div>
						</div>
					</div>
				</div>
			</div>
			<h:inputHidden value="#{serverModel.postPageLoad1}" />
			<h:inputHidden id="dpFlag" value="#{serverModel.featureFlag}"></h:inputHidden>
			<h:inputHidden id="qcFlag" value="#{serverModel.qcFlag}"></h:inputHidden>
		</h:form>


	</f:view>
	<script type="text/javascript">
		function validate() {

			var flag = 0;
			document.getElementById("error").innerText = "";
			document.getElementById("error").textContent = "";
			var userName = document.getElementById("caseInput:accession").value;

			if (/[^0-9a-zA-Z\s]/gi.test(userName)) {

				document.getElementById("error").innerText = "Only Alphanumeric Characters are allowed";
				document.getElementById("error").textContent = "Only Alphanumeric Characters are allowed";
				return true;
			} else
				return false;

		}
        showOrhideDiv();
        function showOrhideDiv(){ 
        	var e = document.getElementById("maindiv");
			
			var caseno = document.getElementById("caseInput:caseNoQC").value;
			var flag = document.getElementById("caseInput:qcFlag").value;
			
			if ((flag == 'true')&amp;&amp;(caseno != '')) {
				
				e.style.display = 'block';
			} 
			else{
				e.style.display = 'none';
			}
			
        }
        
		showhide(); 

		function showhide() {
			var e = document.getElementById("feature_pg");
			var er = document.getElementById("formDiv");

			var flag = document.getElementById("caseInput:dpFlag").value;

			if (flag == 'false') {
				e.style.display = 'none';
				er.style.display = 'block';
			} else {
				e.style.display = 'block';
				er.style.display = 'none'
				er.readOnly = true;
			}
		}

		showText();
		function showText() {

			var correctDx = document.getElementById("caseInput:diagnosis").value;

			if (correctDx == 'Other')
				document.getElementById('inputTex').style.display = 'block';
			else
				document.getElementById('inputTex').style.display = 'none';
		}
		checkNumber();
		function checkNumber() {
			document.getElementById("age_error").innerText = "";
			document.getElementById("age_error").textContent = "";
			var age = document.getElementById("caseInput:age").value;
			if (isNaN(age)) {
				document.getElementById("age_error").innerText = "Only Numbers are allowed";
				document.getElementById("age_error").textContent = "Only Numbers are allowed";
				return true;
			} else if (age > 100) {
				document.getElementById("age_error").innerText = "Numbers(1-100) are allowed";
				document.getElementById("age_error").textContent = "Numbers(1-100) are allowed";
				return true;
			}
			return false;

		}
		function showQCWindow() {
			window
					.open('./qualityControl.jsf', 'mywindow',
							'resizable=no,toolbar=no,scrollbars=yes,height=450,width=530,top=145,left=235');
			return true;

		}
	</script>
	
</h:body>

</html>